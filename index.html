<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modul Video Olahraga MPU3411</title>
    
    <style>
        /* --- CSS: REKA BENTUK MODEN & KEMAS --- */
        :root {
            --bg-gradient: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            --glass-bg: rgba(255, 255, 255, 0.95);
            --header-color: #ffffff;
            --primary-color: #2a5298;
            --accent-color: #e74c3c;
        }

        body {
            margin: 0;
            padding: 20px;
            font-family: 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-gradient);
            min-height: 100vh;
            color: #333;
        }

        h1 {
            text-align: center;
            color: var(--header-color);
            margin-bottom: 30px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        /* Bekas Utama (Upload Form) */
        .upload-container {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            padding: 25px;
            border-radius: 15px;
            max-width: 600px;
            margin: 0 auto 40px auto;
            color: white;
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
        }

        /* Input Styles */
        label { display: block; margin-bottom: 5px; font-weight: 600; font-size: 0.9rem;}
        
        select, input, textarea {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border-radius: 8px;
            border: none;
            box-sizing: border-box;
            font-family: inherit;
        }

        button.btn-upload {
            width: 100%;
            padding: 12px;
            background: #2ecc71;
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            font-size: 1rem;
        }
        
        button.btn-upload:hover { background: #27ae60; }

        /* --- BAHAGIAN KATEGORI (UX BARU) --- */
        .category-section {
            background: var(--glass-bg);
            max-width: 800px;
            margin: 0 auto 25px auto;
            border-radius: 12px;
            overflow: hidden; /* Supaya header tak lari */
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .category-header {
            background: var(--primary-color);
            color: white;
            padding: 15px 20px;
            font-size: 1.1rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .category-content {
            padding: 15px;
            min-height: 50px;
        }

        /* Kad Video */
        .video-card {
            border-left: 5px solid var(--primary-color);
            background: #f8f9fa;
            margin-bottom: 10px;
            padding: 12px;
            border-radius: 4px;
            transition: transform 0.2s;
        }

        .video-card:hover { transform: translateX(5px); background: white; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }

        .video-meta {
            font-size: 0.8rem;
            color: #666;
            margin-bottom: 5px;
            display: flex;
            justify-content: space-between;
        }

        .video-title { font-weight: bold; color: #333; margin-bottom: 5px; display: block; }
        .video-note { font-size: 0.9rem; color: #555; margin-bottom: 10px; font-style: italic; }

        .btn-watch {
            display: inline-block;
            background: var(--accent-color);
            color: white;
            text-decoration: none;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        /* Loader */
        .loader { text-align: center; padding: 20px; color: white; display: none; }
    </style>
</head>
<body>

    <h1>Modul Video Olahraga MPU3411</h1>

    <div class="upload-container">
        <h3 style="margin-top:0; text-align:center;">ðŸ“¤ Muat Naik Bahan Baru</h3>
        
        <label>Pilih Kategori/Acara:</label>
        <select id="topik">
            <option value="" disabled selected>-- Sila Pilih --</option>
            <optgroup label="1.0 Pengenalan">
                <option value="1.0 Pengenalan Olahraga">1.0 Pengenalan Olahraga</option>
            </optgroup>
            <optgroup label="2.0 Kepegawaian">
                <option value="2.0 Kepegawaian">2.0 Kepegawaian & Undang-undang</option>
            </optgroup>
            <optgroup label="3.0 Balapan">
                <option value="3.1 Lari Pecut">3.1 Lari Pecut</option>
                <option value="3.2 Lari Berganti-ganti">3.2 Lari Berganti-ganti</option>
                <option value="3.3 Lari Berpagar">3.3 Lari Berpagar</option>
            </optgroup>
            <optgroup label="4.0 Padang">
                <option value="4.1 Lontar Peluru">4.1 Lontar Peluru</option>
                <option value="4.2 Lompat Jauh">4.2 Lompat Jauh</option>
                <option value="4.3 Lompat Tinggi">4.3 Lompat Tinggi</option>
            </optgroup>
            <optgroup label="5.0 Pengurusan">
                <option value="5.0 Penyediaan Trek">5.0 Penyediaan Trek & Sektor</option>
            </optgroup>
        </select>

        <label>Pautan Video (GDrive/YouTube):</label>
        <input type="url" id="videoLink" placeholder="https://..." required>

        <label>Catatan:</label>
        <textarea id="catatan" rows="2" placeholder="Nota ringkas..."></textarea>

        <button class="btn-upload" onclick="hantarData()">Simpan Data</button>
        <div id="loader" class="loader">Sedang menyimpan...</div>
    </div>

    <div style="max-width: 800px; margin: 0 auto; text-align: right; margin-bottom: 10px;">
        <button onclick="muatTurunData()" style="background: white; border:none; padding:8px 15px; border-radius:20px; cursor:pointer;">â†» Kemaskini</button>
    </div>

    <div class="category-section">
        <div class="category-header">1.0 Pengenalan Olahraga</div>
        <div id="list-1" class="category-content"><small>Tiada video.</small></div>
    </div>

    <div class="category-section">
        <div class="category-header">2.0 Kepegawaian & Undang-undang</div>
        <div id="list-2" class="category-content"><small>Tiada video.</small></div>
    </div>

    <div class="category-section">
        <div class="category-header">3.0 Kemahiran Acara Balapan</div>
        <div id="list-3" class="category-content"><small>Tiada video.</small></div>
    </div>

    <div class="category-section">
        <div class="category-header">4.0 Kemahiran Acara Padang</div>
        <div id="list-4" class="category-content"><small>Tiada video.</small></div>
    </div>

    <div class="category-section">
        <div class="category-header">5.0 Pengurusan Fasiliti</div>
        <div id="list-5" class="category-content"><small>Tiada video.</small></div>
    </div>

    <footer style="text-align: center; color: rgba(255,255,255,0.6); padding-bottom: 20px;">
        Â©2026 Modul Pengajaran MPU3411
    </footer>

    <script>
        // ============================================
        // MASUKKAN URL APP SCRIPT DI BAWAH
        // ============================================
        const WEB_APP_URL = "MASUKKAN_URL_GOOGLE_APPS_SCRIPT_ANDA_DI_SINI"; 

        function hantarData() {
            const topik = document.getElementById('topik').value;
            const link = document.getElementById('videoLink').value;
            const catatan = document.getElementById('catatan').value;
            const loader = document.getElementById('loader');

            if (!topik || !link) { alert("Sila lengkapkan maklumat."); return; }

            loader.style.display = 'block';

            fetch(WEB_APP_URL, {
                method: "POST",
                body: new URLSearchParams({ "action": "insert", "topik": topik, "link": link, "catatan": catatan })
            })
            .then(res => res.json())
            .then(data => {
                loader.style.display = 'none';
                if(data.result === 'success') {
                    alert("Berjaya disimpan!");
                    document.getElementById('videoLink').value = "";
                    document.getElementById('catatan').value = "";
                    muatTurunData(); // Refresh senarai
                } else {
                    alert("Ralat: " + data.error);
                }
            });
        }

        function muatTurunData() {
            // Reset semua kotak kepada "Loading..."
            ['list-1', 'list-2', 'list-3', 'list-4', 'list-5'].forEach(id => {
                document.getElementById(id).innerHTML = '<small>Sedang memuatkan...</small>';
            });

            fetch(WEB_APP_URL)
            .then(res => res.json())
            .then(response => {
                const data = response.data;
                
                // Kosongkan semua kotak sebelum isi data baru
                const containers = {
                    '1': document.getElementById('list-1'),
                    '2': document.getElementById('list-2'),
                    '3': document.getElementById('list-3'),
                    '4': document.getElementById('list-4'),
                    '5': document.getElementById('list-5')
                };

                // Bersihkan kandungan
                for (let key in containers) { containers[key].innerHTML = ""; }

                // Jika tiada data langsung
                if (data.length === 0) {
                    for (let key in containers) { containers[key].innerHTML = "<small>Tiada rekod.</small>"; }
                    return;
                }

                // Loop setiap video dan masukkan ke kotak yang betul
                data.reverse().forEach(item => {
                    const card = document.createElement('div');
                    card.className = 'video-card';
                    
                    const dateStr = new Date(item.timestamp).toLocaleDateString('ms-MY');

                    card.innerHTML = `
                        <div class="video-meta">
                            <span style="background:#ddd; padding:2px 6px; border-radius:4px; font-weight:bold;">${item.topik}</span>
                            <span>${dateStr}</span>
                        </div>
                        <div class="video-note">${item.catatan || "Tiada nota."}</div>
                        <a href="${item.link}" target="_blank" class="btn-watch">â–¶ Tonton Video</a>
                    `;

                    // LOGIK PENGASINGAN (SORTING)
                    // Kita tengok nombor depan topik (1.0, 3.1, dsb)
                    if (item.topik.startsWith("1")) containers['1'].appendChild(card);
                    else if (item.topik.startsWith("2")) containers['2'].appendChild(card);
                    else if (item.topik.startsWith("3")) containers['3'].appendChild(card);
                    else if (item.topik.startsWith("4")) containers['4'].appendChild(card);
                    else if (item.topik.startsWith("5")) containers['5'].appendChild(card);
                });

                // Cek jika ada kotak yang masih kosong
                for (let key in containers) {
                    if (containers[key].innerHTML === "") containers[key].innerHTML = "<small style='color:#888; padding:10px;'>Tiada video untuk kategori ini.</small>";
                }
            });
        }

        window.onload = muatTurunData;
    </script>
</body>
</html>
